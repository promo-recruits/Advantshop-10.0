//--------------------------------------------------
// Project: AdvantShop.NET
// Web site: http:\\www.advantshop.net
//--------------------------------------------------

using System.Collections.Generic;
using System.Web;

namespace AdvantShop.Helpers
{
    public class BrowsersHelper
    {
        const string urlOldBrowsersPage = "~/content/oldBrowser/default.aspx";

        public static Dictionary<string, int> SupportedBrowsers = new Dictionary<string, int>() {
            {"IE", 10},
        };

        public static bool IsSupportedBrowser()
        {
            HttpBrowserCapabilities browser = HttpContext.Current.Request.Browser;

            return SupportedBrowsers.ContainsKey(browser.Browser) ? SupportedBrowsers[browser.Browser] <= browser.MajorVersion : true;
        }

        public static void CheckSupportedBrowser()
        {
            HttpBrowserCapabilities browser = HttpContext.Current.Request.Browser;

            if (!IsSupportedBrowser())
            {
                RedirectToOldBrowsersPage();
            }
        }

        public static void RedirectToOldBrowsersPage()
        {
            HttpContext.Current.Response.Redirect(urlOldBrowsersPage, true);
        }


        public static bool IsBot()
        {
            if (HttpContext.Current == null || HttpContext.Current.Request == null)
            {
                return false;
            }

            return IsBotByUserAgent(HttpContext.Current.Request.UserAgent ?? "") || IsBotByIp(HttpContext.Current.Request.UserHostAddress);
        }

        private static bool IsBotByIp(string ip)
        {
            return BotsIPs.Contains(ip);
        }

        private static bool IsBotByUserAgent(string userAgent)
        {
            userAgent = userAgent.ToLower();
            return userAgent.Contains("bot") || userAgent.Contains("parser") || userAgent.Contains("crawl") || userAgent.Contains("spider");
        }


        private static List<string> BotsIPs = new List<string>() {
            "10.0.2.33",
            "109.120.187.91",
            "130.193.50.24",
            "130.193.51.73",
            "138.201.140.91",
            "141.101.228.20",
            "141.101.228.21",
            "141.101.228.22",
            "141.101.228.23",
            "141.101.231.142",
            "141.101.231.143",
            "141.101.231.31",
            "141.101.231.33",
            "141.101.231.77",
            "141.8.132.18",
            "141.8.132.2",
            "141.8.132.23",
            "141.8.132.24",
            "141.8.132.25",
            "141.8.132.6",
            "141.8.142.1",
            "141.8.142.10",
            "141.8.142.187",
            "141.8.142.22",
            "141.8.142.31",
            "141.8.142.49",
            "141.8.142.55",
            "141.8.142.61",
            "141.8.142.84",
            "141.8.142.88",
            "141.8.142.9",
            "141.8.142.94",
            "141.8.183.21",
            "141.8.183.215",
            "141.8.184.30",
            "144.76.101.171",
            "148.251.223.21",
            "148.251.82.8",
            "176.121.14.111",
            "176.121.14.113",
            "176.121.14.121",
            "176.121.14.136",
            "176.121.14.163",
            "176.121.14.165",
            "176.121.14.166",
            "176.121.14.167",
            "176.121.14.170",
            "176.121.14.69",
            "178.154.171.11",
            "178.154.171.14",
            "178.154.171.15",
            "178.154.171.29",
            "178.154.171.3",
            "178.154.171.39",
            "178.154.171.55",
            "178.154.171.63",
            "178.154.171.88",
            "178.154.189.16",
            "178.154.189.8",
            "178.154.200.33",
            "178.154.200.6",
            "178.154.224.71",
            "185.41.186.67",
            "188.164.250.118",
            "188.164.251.127",
            "192.168.0.10",
            "192.168.200.1",
            "192.168.222.117",
            "193.124.56.46",
            "194.28.84.75",
            "195.128.120.141",
            "195.133.49.173",
            "195.234.4.40",
            "212.193.117.245",
            "212.76.128.209",
            "213.180.203.2",
            "213.180.203.25",
            "213.180.203.26",
            "213.180.203.35",
            "213.180.203.37",
            "213.180.203.57",
            "213.180.203.61",
            "213.180.206.196",
            "216.244.66.228",
            "217.24.190.151",
            "23.237.4.26",
            "31.173.72.193",
            "31.31.196.115",
            "31.31.196.126",
            "31.31.196.211",
            "37.140.192.131",
            "37.140.192.132",
            "37.140.192.137",
            "37.140.192.149",
            "37.140.192.244",
            "37.140.192.61",
            "37.140.192.99",
            "37.18.74.140",
            "37.18.74.154",
            "37.18.74.162",
            "37.18.74.177",
            "37.18.74.41",
            "37.18.74.46",
            "37.18.74.48",
            "37.18.74.87",
            "37.18.77.112",
            "37.18.77.115",
            "37.18.77.124",
            "37.18.77.127",
            "37.18.77.148",
            "37.18.77.167",
            "37.18.77.172",
            "37.18.77.20",
            "37.18.77.204",
            "37.18.77.217",
            "37.18.77.231",
            "37.18.77.238",
            "37.18.77.240",
            "37.18.77.242",
            "37.18.77.247",
            "37.18.77.248",
            "37.18.77.249",
            "37.18.77.250",
            "37.18.77.29",
            "37.18.77.32",
            "37.18.77.41",
            "37.18.77.46",
            "37.18.77.58",
            "37.18.77.63",
            "37.18.77.72",
            "37.18.77.87",
            "37.18.77.89",
            "37.18.77.9",
            "37.18.77.99",
            "37.230.152.116",
            "37.230.152.206",
            "37.230.152.243",
            "37.230.152.248",
            "37.230.153.120",
            "37.230.153.125",
            "37.230.153.173",
            "37.230.153.78",
            "37.230.154.105",
            "37.230.154.118",
            "37.230.154.141",
            "37.230.154.145",
            "37.230.154.160",
            "37.230.154.163",
            "37.230.154.169",
            "37.230.154.186",
            "37.230.154.189",
            "37.230.154.198",
            "37.230.154.207",
            "37.230.154.47",
            "37.230.154.48",
            "37.230.154.70",
            "37.230.154.71",
            "37.230.154.73",
            "37.230.154.79",
            "37.9.113.110",
            "37.9.113.114",
            "37.9.113.116",
            "37.9.113.126",
            "37.9.113.133",
            "37.9.113.145",
            "37.9.113.148",
            "37.9.113.157",
            "37.9.113.192",
            "37.9.113.202",
            "37.9.113.52",
            "37.9.113.53",
            "37.9.113.66",
            "37.9.113.87",
            "37.9.113.90",
            "37.9.118.28",
            "46.229.168.65",
            "46.229.168.66",
            "46.229.168.67",
            "46.229.168.68",
            "46.229.168.69",
            "46.229.168.70",
            "46.229.168.71",
            "46.229.168.72",
            "46.229.168.73",
            "46.229.168.74",
            "46.229.168.75",
            "46.229.168.76",
            "46.229.168.77",
            "46.229.168.78",
            "46.229.168.79",
            "46.229.168.80",
            "46.4.89.220",
            "46.4.94.226",
            "46.8.117.207",
            "5.255.253.1",
            "5.255.253.38",
            "5.255.253.52",
            "5.255.253.74",
            "5.45.207.31",
            "5.45.207.52",
            "5.45.207.54",
            "5.45.207.55",
            "5.45.207.63",
            "5.45.207.66",
            "5.45.207.85",
            "5.45.207.86",
            "5.45.235.101",
            "5.61.41.104",
            "5.79.68.55",
            "62.210.247.93",
            "62.90.131.202",
            "66.249.89.208",
            "68.180.230.45",
            "68.180.231.42",
            "77.88.47.40",
            "77.88.47.60",
            "78.140.167.143",
            "81.177.143.251",
            "81.177.174.9",
            "81.177.48.104",
            "84.201.148.71",
            "84.201.148.82",
            "87.242.111.23",
            "87.242.112.39",
            "87.242.112.42",
            "87.250.224.108",
            "87.250.224.120",
            "87.250.224.121",
            "87.250.224.127",
            "87.250.224.214",
            "87.250.224.47",
            "87.250.224.61",
            "87.250.224.73",
            "87.250.224.75",
            "87.250.224.91",
            "87.250.224.92",
            "87.250.233.77",
            "88.85.95.105",
            "88.99.242.14",
            "89.169.36.32",
            "89.169.95.95",
            "91.203.195.18",
            "91.204.252.230",
            "91.204.252.232",
            "93.125.99.64",
            "93.158.141.26",
            "93.158.141.50",
            "93.158.161.35",
            "94.249.192.60",
            "95.108.129.196",
            "95.108.181.119",
            "95.108.181.47",
            "95.108.181.58",
            "95.108.181.64",
            "95.108.181.73",
            "95.108.181.75",
            "95.108.181.89",
            "95.108.181.91",
            "95.108.213.23",
            "95.108.213.24",
            "95.108.213.9",
            "95.29.24.62"
        };
    }
}
