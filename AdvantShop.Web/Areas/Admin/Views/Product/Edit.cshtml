@using AdvantShop.Saas
@using AdvantShop.Core.Services.Bonuses
@using AdvantShop.Repository.Currencies
@model AdvantShop.Web.Admin.Models.Catalog.Products.AdminProductModel
@{
    int inViewThrottle = 300;
    var baseCurrency = CurrencyService.GetAllCurrencies().FirstOrDefault(x => x.Rate == 1f);
    var baseCurrencySymbol = baseCurrency != null ? baseCurrency.Symbol : "BaseCurrency";
}

<form method="POST" action="@Url.Action("Edit")" enctype="multipart/form-data" name="form" novalidate="novalidate">
    @Html.AntiForgeryToken()
    @Html.HiddenFor(x => x.ProductId)

    <div class="wrapper" ng-init="product.form=form; product.initProduct(@Model.ProductId);">
        <div class="grid-classic">
            <div class="grid-classic-row grid-classic-fixed">
                <div class="grid-classic-col grid-classic-col-md" id="leftAsideProduct">
                    @Html.Partial("_LeftMenu", Model)
                </div>
                <div class="grid-classic-col">
                    <div class="m-b-md">
                        <div class="sticky-page-name p-b-n" sticky sticky-top="0">
                            <div class="page-name-block sticky-page-name-inner">
                                <div class="page-name-block-item-main">
                                    <h1 class="page-name-block-text sticky-page-name-text">
                                        @T("Admin.Product.Edit.Goods")"@Model.Name"
                                    </h1>
                                </div>
                                <div class="page-name-block-item-additional">
                                    <a href="" class="link-danger m-r-xs" ng-click="product.deleteProduct(@Model.ProductId)">@T("Admin.Produt.Edit.Delete")</a>
                                    @if (SettingsMain.StoreActive)
                                    {
                                        <a href="@Url.AbsoluteRouteUrl("Product", new {url = Model.UrlPath})" class="btn btn-sm btn-default" target="_blank">@T("Admin.View")</a>
                                    }
                                    <button type="submit" class="btn btn-sm btn-success" data-e2e="btnSave" data-button-validation disabled ng-disabled="!form.modified || product.isProcessGetTags === true">
                                        <i class="fa fa-check"></i> @T("Admin.Save")
                                    </button>
                                </div>
                            </div>
                        </div>
                        @Html.Partial("BreadCrumbs", Model.BreadCrumbs)
                    </div>
                    <div class="ibox">
                        <div class="ibox-content relative" id="scroll-container">

                            <div class="row">
                                <div class="col-xs-8 col-wl-9">
                                    @Html.RenderModules("admin_product_top", new { productId = Model.ProductId })

                                    <div class="product-setting product-setting--main">
                                        <div id="main">
                                            <div class="container-fluid">
                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <div class="flex top-xs">
                                                            <h2 class="inline product-setting-title content-header">@T("Admin.Product.Edit.Main")</h2>

                                                            <a href="https://www.advantshop.net/help/pages/add-product" target="_blank" class="p-l-sm link-academy link-invert inline-flex middle-xs" style="padding-top:3px;">

                                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve" width="18" height="18" fill="#989a9b" class="m-r-xs">
<path d="M20.005,512c-5.097,0-10.116-1.948-13.925-5.641c-5.845-5.666-7.672-14.309-4.621-21.855l45.411-112.333  C16.162,332.253,0,285.425,0,236c0-63.375,26.855-122.857,75.62-167.489C123.891,24.331,187.952,0,256,0  s132.109,24.331,180.38,68.511C485.145,113.143,512,172.625,512,236c0,45.448-14.04,89.577-40.602,127.615  c-6.325,9.057-18.792,11.271-27.849,4.947s-11.271-18.792-4.947-27.849C460.452,309.425,472,273.215,472,236  c0-108.075-96.897-196-216-196S40,127.925,40,236c0,43.783,15.577,85.2,45.046,119.773c4.834,5.671,6.115,13.561,3.321,20.47  l-31.366,77.589l91.345-40.266c5.063-2.231,10.826-2.267,15.916-0.095C193.082,425.766,223.946,432,256,432  c36.892,0,73.299-8.587,105.286-24.832c9.85-5,21.887-1.072,26.889,8.775c5.001,9.849,1.073,21.887-8.775,26.889  C341.828,461.914,299.157,472,256,472c-34.48,0-67.835-6.191-99.276-18.413L28.068,510.301C25.474,511.444,22.728,512,20.005,512z   M276,325V217c0-11.046-8.954-20-20-20s-20,8.954-20,20v108c0,11.046,8.954,20,20,20S276,336.046,276,325z M256,128  c-11.046,0-20,8.954-20,20l0,0c0,11.046,8.954,20,20,20s20-8.954,20-20l0,0C276,136.954,267.046,128,256,128z" />
                                                                </svg>
                                                                <span>Инструкция. Как добавить новый товар</span>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="container-fluid">
                                                <div class="form-group middle-xs row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <label for="ProductName" class="text-required">@T("Admin.Product.Edit.ProductName")</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        @Html.TextBoxFor(x => x.Name, new { @class = "form-control", ng_model = "product.Name", required = "required", validation_input_text = T("Admin.Product.Edit.ProductName").ToString() })
                                                        <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.ProductName")">
                                                            <p>@T("Admin.Product.Edit.NameOfComodityItem")</p>
                                                            <p>@T("Admin.Product.Edit.ObligatoryField")</p>
                                                        </help-trigger>
                                                    </div>
                                                </div>

                                                <div class="form-group middle-xs row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <label for="ArtNo" class="text-required">@T("Admin.Product.Edit.VendorCode")</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        @Html.TextBoxFor(x => x.ArtNo, new { @class = "form-control", ng_model = "product.ArtNo", required = "required", validation_input_text = T("Admin.Product.Edit.VendorCode").ToString() })
                                                        <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.ProductVendorCode")">
                                                            <p>@T("Admin.Product.Edit.VendorCodeUnique")</p>
                                                            <p>@T("Admin.Product.Edit.UsedToFind")</p>
                                                        </help-trigger>
                                                    </div>
                                                </div>

                                                <div class="form-group middle-xs row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <label for="Enabled" class="form-label-block">@T("Admin.Product.Edit.Activity")</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        <label class="adv-checkbox-label form-label-block" data-e2e="ProductEnabled">
                                                            @Html.CheckBoxFor(x => x.Enabled, new { ng_model = "product.enabled", ng_init = "product.enabled=" + Model.Enabled.ToLowerString(), @class = "adv-checkbox-input" })
                                                            <span class="adv-checkbox-emul" data-e2e="CheckBoxEnabledClick"></span>
                                                        </label>
                                                        
                                                        @if (Model.Hidden)
                                                        {
                                                            <span class="p-l-sm error-color">Скрытый товар</span>
                                                            <help-trigger class="ng-cloak" data-title="Скрытый товар">
                                                                Скрытый товар не отображается в каталоге и не учавствует в поиске, но в него можно перейти. Товар может быть скрытым при помощи модуля. Например, Сималенд.
                                                            </help-trigger>
                                                        }
                                                    </div>
                                                </div>
                                                @*24.10.18 функционал скрыт, не доделан вывод товаров в клиентке по наличию в каналах*@
                                                @if (false)
                                                {
                                                    <div class="form-group middle-xs row">
                                                        <div class="col-xs-2">
                                                            <div class="setting-label-wrap">
                                                                <label for="Enabled" class="form-label-block">@T("Admin.Product.Edit.EnabledInSalesChannel")</label>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-6 relative">
                                                            Доступно в {{product.enableSalesChannelCount}} из {{product.allSalesChannelCount}}
                                                            <ui-modal-trigger data-controller="'ModalSalesChannelExcludedCtrl'" controller-as="ctrl"
                                                                              @*data-on-close="product.addCategory(result)"*@
                                                                              data-on-close="product.loadSalesChannels(@Model.ProductId)"
                                                                              data-resolve="{data: {productId: @Model.ProductId}}"
                                                                              template-url="../areas/admin/content/src/_shared/modal/salesChannelExcluded/SalesChannelExcluded.html">
                                                                (<a href="" data-e2e="SalesChannelEdit">@T("Admin.Product.Edit.SetExcludedSalesChannel")</a>)
                                                            </ui-modal-trigger>
                                                        </div>
                                                    </div>
                                                }
                                                <div class="form-group top-xs row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <label for="category">@T("Admin.Product.Edit.Category")</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        <select bs-modifiable="false"
                                                                class="form-control form-control-category" multiple
                                                                ng-model="product.category"
                                                                ng-options="c.label for c in product.categories track by c.value" data-e2e="ProductCategory"></select>
                                                        <div class="note">
                                                            <ui-modal-trigger data-controller="'ModalAddCategoryCtrl'" controller-as="ctrl"
                                                                              data-on-close="product.addCategories(result)"
                                                                              data-resolve="{showRoot: false}"
                                                                              template-url="../areas/admin/content/src/_shared/modal/addCategory/AddCategory.html">
                                                                <a href="" data-e2e="CategoryAdd">@T("Admin.Product.Edit.Add")</a>
                                                            </ui-modal-trigger>
                                                            <a href="" ng-if="product.category != null" ng-click="product.deleteCategory()" class="link-danger word-spacing ng-cloak" data-e2e="CategoryDelete">@T("Admin.Product.Edit.Delete")</a>
                                                            <a href="" ng-click="product.setMainCategory()" class="word-spacing" data-e2e="CategorySetMain">@T("Admin.Product.Edit.Default")</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <div>@T("Admin.Product.Edit.Markers")</div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        <div class="form-group label-wrap">
                                                            <label class="adv-checkbox-label word-spacing category-label">
                                                                @Html.CheckBoxFor(x => x.BestSeller, new { @class = "adv-checkbox-input absolute", ng_model = "product.BestSeller", ng_init = "product.BestSeller=" + Model.BestSeller.ToLowerString() })
                                                                @T("Admin.Product.Edit.Bestseller")
                                                                <span class="adv-checkbox-emul" data-e2e="CheckBoxBestSellerClick"></span>
                                                            </label>
                                                            <label class="adv-checkbox-label word-spacing category-label">
                                                                @Html.CheckBoxFor(x => x.Recomended, new { @class = "adv-checkbox-input absolute", ng_model = "product.Recomended", ng_init = "product.Recomended=" + Model.Recomended.ToLowerString() })
                                                                @T("Admin.Product.Edit.Recommended")
                                                                <span class="adv-checkbox-emul" data-e2e="CheckBoxRecomendedClick"></span>
                                                            </label>
                                                            <label class="adv-checkbox-label word-spacing category-label">
                                                                @Html.CheckBoxFor(x => x.New, new { @class = "adv-checkbox-input absolute", ng_model = "product.New", ng_init = "product.New=" + Model.New.ToLowerString() })
                                                                @T("Admin.Product.Edit.Novelty")
                                                                <span class="adv-checkbox-emul" data-e2e="CheckBoxNewClick"></span>
                                                            </label>
                                                            <label class="adv-checkbox-label word-spacing category-label nowrap">
                                                                @Html.CheckBoxFor(x => x.Sales, new { @class = "adv-checkbox-input absolute", ng_model = "product.Sales", ng_init = "product.Sales=" + Model.Sales.ToLowerString() })
                                                                @T("Admin.Product.Edit.Sale")
                                                                <span class="adv-checkbox-emul" data-e2e="CheckBoxSalesClick"></span>
                                                            </label>
                                                            <help-trigger class="ng-cloak" data-title="@T("Admin.Product.Edit.Markers")">
                                                                @T("Admin.Product.Edit.ProductMarkers") <a href="http://www.advantshop.net/help/pages/markers" target="_blank">@T("Admin.Product.Edit.MarkersHitSaleDiscount")</a>
                                                            </help-trigger>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group middle-xs row" ng-show="!product.useOfferBarCode">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <label for="barcode">@T("Admin.Product.Edit.Barcode")</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        @Html.TextBoxFor(x => x.BarCode, new { @class = "form-control", ng_model = "product.BarCode", validation_input_text = T("Admin.Product.Edit.Barcode").ToString() })
                                                        <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.ProductBarcode")">
                                                            <p>@T("Admin.Product.Edit.BarcodeIsUnique")</p>
                                                            <p>@T("Admin.Product.Edit.BarcodeHint")</p>
                                                        </help-trigger>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-xs-2">
                                                        <div class="setting-label-wrap">
                                                            <div>@T("Admin.Product.Edit.Export")</div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-9 relative">
                                                        <ui-modal-trigger size="middle" data-controller="'ModalExportOptionsCtrl'" controller-as="ctrl"
                                                                          template-url="../areas/admin/content/src/product/modal/exportOptions/exportOptions.html"
                                                                          data-resolve="{ 'productId': @Model.ProductId }">
                                                            <a class="product-setting-link" href="">@T("Admin.Product.Edit.ExportOptions")</a>
                                                        </ui-modal-trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-xs-4 col-wl-3">
                                    @Html.Partial("_RightBlock", Model)

                                </div>
                            </div>

                            <div class="product-setting product-setting--price">
                                <div id="price">
                                    <div class="container-fluid">
                                        <div class="row middle-xs">
                                            <div class="col-xs-12">
                                                <h2 class="inline product-setting-title content-header">@T("Admin.Product.Edit.PriceAndAvailability")</h2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="currency">@T("Admin.Product.Edit.Currency")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-wl-2 relative">
                                                @Html.DropDownListFor(x => x.CurrencyId, Model.Currencies, new { @class = "form-control", ng_model = "product.CurrencyId", ng_init = "product.CurrencyId='" + Model.CurrencyId + "'" })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.Currency")">
                                                    <p>@T("Admin.Product.Edit.CanChooseCurrency")</p>
                                                    <p>@T("Admin.Product.Edit.LearnMoreAboutCurrencies")</p>
                                                    <p><a href="http://www.advantshop.net/help/pages/currency" target="_blank">@T("Admin.Product.Edit.InsctructionSettingCurrency")</a></p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="discounts">@T("Admin.Product.Edit.Discounts")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-wl-2 relative">
                                                <div class="input-group" ng-init="product.discountType=@((int)Model.DiscountType)">
                                                    @Html.TextBoxFor(x => x.DiscountPercent, new { @class = "form-control" + (Model.DiscountType != AdvantShop.Catalog.DiscountType.Percent ? " ng-hide" : ""), ng_model = "product.DiscountPercent", ng_show = "product.discountType === 0", validation_input_float = "", min = "0", max = "100", type ="number", validation_input_text = T("Admin.Product.Edit.Discounts").ToString() })
                                                    @Html.TextBoxFor(x => x.DiscountAmount, new { @class = "form-control" + (Model.DiscountType != AdvantShop.Catalog.DiscountType.Amount ? " ng-hide" : ""), ng_model = "product.DiscountAmount", ng_show = "product.discountType === 1", validation_input_float = "", min = "0", type = "number", validation_input_text = T("Admin.Product.Edit.Discounts").ToString() })
                                                    <div class="input-group-btn">
                                                        <span class="btn btn-default @(Model.DiscountType == AdvantShop.Catalog.DiscountType.Percent ? "product-currency-active" : "")" ng-click="product.setDiscountType(0)" ng-class="{'product-currency-active':product.discountType === 0}" data-e2e="DiscountPercent"><span>%</span></span>
                                                        <span class="btn btn-default @(Model.DiscountType == AdvantShop.Catalog.DiscountType.Amount ? "product-currency-active" : "")" ng-click="product.setDiscountType(1)" ng-class="{'product-currency-active':product.discountType === 1}" data-e2e="DiscountAmount"><span>@Model.Currency.Symbol</span></span>
                                                    </div>
                                                </div>
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.Discounts")">
                                                    <p>@T("Admin.Product.Edit.DiscountOnThePrice")</p>
                                                    <p>@T("Admin.Product.Edit.DiscountInPercentageOrCurrency")</p>
                                                </help-trigger>
                                            </div>
                                            <div class="col-xs-6 relative m-l">
                                                <div class="label-wrap">
                                                    <label class="adv-checkbox-label category-label">
                                                        @Html.CheckBoxFor(x => x.AllowPreOrder, new { @class = "adv-checkbox-input absolute", ng_model = "product.AllowPreOrder", ng_init = "product.AllowPreOrder=" + Model.AllowPreOrder.ToLowerString() })
                                                        <span class="adv-checkbox-emul" data-e2e="AllowPreOrderClick"></span>
                                                        <span class="italic">@T("Admin.Product.Edit.OnRequestOrStock")</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    @if (BonusSystem.IsActive)
                                    {
                                        <div class="container-fluid">
                                            <div class="form-group middle-xs row">
                                                <div class="col-xs-2">
                                                    <div class="setting-label-wrap">
                                                        <label for="AccrueBonuses">@T("Admin.Product.Edit.AddPointsForProduct")</label>
                                                    </div>
                                                </div>
                                                <div class="col-xs-6 relative">
                                                    <label class="adv-checkbox-label form-label-block" data-e2e="ChargeBonuses">
                                                        @Html.CheckBoxFor(x => x.AccrueBonuses, new { @class = "adv-checkbox-input", ng_model = "product.AccrueBonuses" })
                                                        <span class="adv-checkbox-emul"></span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    }

                                    <div class="container-fluid grid-offers-wrapper" ng-init="product.initOffers(@Model.UseOfferWeightAndDimensions.ToLowerString(), @Model.UseOfferBarCode.ToLowerString())" lozad-adv="product.scrollToActiveElement('gridOffersShowed')">
                                        <div class="form-group row ng-cloak" ng-if="product.gridOffersShowed">
                                            <div class="col-xs-12 col-wl-12" ng-init="product.getOffersValidation()">
                                                <div ng-if="product.offersValidation != null" ng-bind="product.offersValidation" class="m-b error-color"></div>
                                                <ui-grid-custom grid-unique-id="gridOffers"
                                                                grid-on-init="product.gridOffersOnInit(grid)"
                                                                grid-filter-enabled="false"
                                                                grid-pagination-enabled="false"
                                                                grid-selection-enabled="false"
                                                                grid-params="{ProductId: product.productId}"
                                                                grid-options="product.gridOffersOptions"
                                                                grid-url="'product/getOffers'"
                                                                grid-inplace-url="'product/updateOffer'"
                                                                grid-empty-text="'@T("Admin.Product.Edit.ProductHasNoPrices")'"
                                                                grid-on-inplace-apply="product.gridOffersUpdate()"
                                                                grid-extend-ctrl="product"
                                                                grid-row-identificator="'OfferId'">
                                                </ui-grid-custom>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid m-b-sm">
                                        <div class="form-group row">
                                            <div class="col-xs-12">
                                                <ui-modal-trigger data-controller="'ModalAddEditOfferCtrl'" controller-as="ctrl" template-url="../areas/admin/content/src/product/modal/addEditOffer/addEditOffer.html"
                                                                  data-resolve="{'ProductId': product.productId, 'UseOfferWeightAndDimensions': product.useOfferWeightAndDimensions, 'UseOfferBarCode': product.useOfferBarCode}"
                                                                  data-on-close="product.gridOffersUpdate()">
                                                    <a href="" class="btn btn-sm btn-action">@T("Admin.Product.Edit.AddPrice")</a>
                                                </ui-modal-trigger>
                                                <span class="m-l-xs">@T("Admin.product.Edit.Directories") <a href="@Url.Action("Index", "Colors")" target="_blank">@T("Admin.Product.Edit.OfColors")</a> @T("Admin.Product.Edit.And") <a href="@Url.Action("Index", "Sizes")" target="_blank">@T("Admin.Product.Edit.Sizes")</a></span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="TaxId">@T("Admin.Product.Edit.Tax")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-wl-2 relative">
                                                @Html.DropDownListFor(x => x.TaxId, Model.Taxes, new { @class = "form-control", ng_model = "product.TaxId", ng_init = "product.TaxId='" + Model.TaxId + "'" })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.Tax")">
                                                    <p>@T("Admin.Product.Edit.SpecifyTax")</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="PaymentSubjectType">Предмет расчета</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-wl-2 relative">
                                                @Html.DropDownListFor(x => x.PaymentSubjectType, Model.PaymentSubjectTypes, new { @class = "form-control", ng_model = "product.PaymentSubjectType", ng_init = "product.PaymentSubjectType='" + Model.PaymentSubjectType + "'" })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="Предмет расчета">
                                                    <p>Данный параметр будет передаваться для печати чеков</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="PaymentMethodType">Способ расчета</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-3 col-wl-2 relative">
                                                @Html.DropDownListFor(x => x.PaymentMethodType, Model.PaymentMethodTypes, new { @class = "form-control", ng_model = "product.PaymentMethodType", ng_init = "product.PaymentMethodType='" + Model.PaymentMethodType + "'" })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="Способ расчета">
                                                    <p>Данный параметр будет передаваться для печати чеков</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="Unit">@T("Admin.Product.Edit.UnitOfMeasure")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-1 relative">
                                                @Html.TextBoxFor(x => x.Unit, new { @class = "form-control", ng_model = "product.Unit" })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.UnitOfMeasure")">
                                                    <p>@T("Admin.Product.Edit.UnitsOfProduct")</p>
                                                    <p>@T("Admin.Product.Edit.Example")<br>@T("Admin.Product.Edit.PiecesLitersEtc")</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="MinAmount">@T("Admin.Product.Edit.LimitationsOnMinimumAndMaximumQuantity")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-1">
                                                @Html.TextBoxFor(x => x.MinAmount, new { @class = "form-control", ng_model = "product.MinAmount", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.MinimumQuantityOfGoods") })
                                            </div>
                                            <div class="dash">-</div>
                                            <div class="col-xs-1 relative" style="line-height: 30px;height: 30px;">
                                                @Html.TextBoxFor(x => x.MaxAmount, new { @class = "form-control", ng_model = "product.MaxAmount", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.MaximumQuantityOfGoods") })
                                                <span>
                                                    <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.MinAndMaxQuantity")">
                                                        <p>@T("Admin.Product.Edit.DefinesMinAndMaxPossibleQuantity")</p>
                                                        <p>@T("Admin.Product.Edit.Example2.10")</p>
                                                        <p>@T("Admin.Product.Edit.IfRestrictionNotNecessery")</p>
                                                    </help-trigger>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="Multiplicity">@T("Admin.Product.Edit.NumberMultiplicity")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-1 relative">
                                                @Html.TextBoxFor(x => x.Multiplicity, new { @class = "form-control", ng_model = "product.Multiplicity", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.NumberMultiplicity").ToString() })
                                                <help-trigger class="ng-cloak help-trigger-icon-abs" data-title="@T("Admin.Product.Edit.NumberMultiplicity")">
                                                    <p>@T("Admin.Product.Edit.ImportantOptionsIfProductLessOne")</p>
                                                    <p>@T("Admin.Product.Edit.ValueMustBeGraterThen0")</p>
                                                    <p>@T("Admin.Product.Edit.ExampleMeters")</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="product-setting product-setting--delivery">
                                <div id="delivery">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <h2 class="inline product-setting-title content-header">@T("Admin.Product.Edit.Delivery")</h2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid" ng-show="!product.useOfferWeightAndDimensions">
                                        <div class="form-group middle-xs row relative">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="Weight">@T("Admin.Product.Edit.Weight")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-1">
                                                @Html.TextBoxFor(x => x.Weight, new { @class = "form-control", ng_model = "product.Weight", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.Weight").ToString() })
                                            </div>
                                            <span>@T("Admin.Product.Edit.Kg")</span>
                                            <help-trigger class="ng-cloak m-l-xs" data-title="@T("Admin.Product.Edit.ProductWeight")">
                                                <p>@T("Admin.Product.Edit.UsedToCalculate")</p>
                                                <p>@T("Admin.Product.Edit.Example")</p>
                                                <ul>
                                                    <li>2 @T("Admin.Product.Edit.Kg")</li>
                                                    <li>1,2 @T("Admin.Product.Edit.Kg")</li>
                                                    <li>0.3 @T("Admin.Product.Edit.Kg")</li>
                                                </ul>
                                            </help-trigger>
                                        </div>
                                    </div>
                                    <div class="container-fluid" ng-show="!product.useOfferWeightAndDimensions">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="Length">@T("Admin.Product.Edit.Dimensions")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-1">
                                                @Html.TextBoxFor(x => x.Length, new { @class = "form-control", ng_model = "product.Length", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.Length").ToString() })
                                                <span class="italic sub">@T("Admin.Product.Edit.Length")</span>
                                            </div>
                                            <div class="dash align-top">-</div>
                                            <div class="col-xs-1">
                                                @Html.TextBoxFor(x => x.Width, new { @class = "form-control", ng_model = "product.Width", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.Width").ToString() })
                                                <span class="italic sub">@T("Admin.Product.Edit.Width")</span>
                                            </div>
                                            <div class="dash align-top">-</div>
                                            <div class="col-xs-1">
                                                @Html.TextBoxFor(x => x.Height, new { @class = "form-control", ng_model = "product.Height", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.Height").ToString() })
                                                <span class="italic sub">@T("Admin.Product.Edit.Height")</span>
                                            </div>
                                            <div class="dash align-top relative">
                                                @T("Admin.Products.Edit.Mm")
                                                <help-trigger class="ng-cloak help-trigger-icon-abs m-l-xs" data-title="@T("Admin.Product.Edit.ProductDimensions")">
                                                    <p>@T("Admin.Product.Edit.UsedToCalculateCosInDeliverySystems")</p>
                                                    <p>@T("Admin.Product.Edit.Example15x20"):</p>
                                                    <ul>
                                                        <li>@T("Admin.Product.Edit.Lenght200")</li>
                                                        <li>@T("Admin.Product.Edit.Width150")</li>
                                                        <li>@T("Admin.Product.Edit.Height3")</li>
                                                    </ul>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="form-group middle-xs row">
                                            <div class="col-xs-2">
                                                <div class="setting-label-wrap">
                                                    <label for="ShippingPrice">@T("Admin.Product.Edit.CostOfDelivery")</label>
                                                </div>
                                            </div>
                                            <div class="col-xs-2 relative">
                                                <div class="input-group">
                                                    @Html.TextBoxFor(x => x.ShippingPrice, new { @class = "form-control", ng_model = "product.ShippingPrice", validation_input_float = "", validation_input_text = T("Admin.Product.Edit.CostOfDelivery").ToString() })
                                                    <div class="input-group-btn">
                                                        <span class="btn btn-default"><span>@baseCurrencySymbol</span></span>
                                                    </div>
                                                </div>
                                                <help-trigger class="ng-cloak help-trigger-icon-abs m-l-xs" data-title="@T("Admin.Product.Edit.CostOfDeliveryOfUnit")">
                                                    <p>@T("Admin.Product.Edit.ThisParameterDeliveryDepending")</p>
                                                    <p>@T("Admin.Product.Edit.ThisParameterExportedIntoYandexMarket")</p>
                                                    <p>@T("Admin.Product.Edit.IfParameterNotNeeded")</p>
                                                </help-trigger>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="product-setting product-setting--photos" lozad-adv="product.scrollToActiveElement('productPhotosShowed')">
                                <div id="photos" bs-modifiable="false">
                                    <div ng-if="product.productPhotosShowed">
                                        <product-photos data-product-id="@Model.ProductId"
                                                        data-show-google-image-search="@Model.ShowGoogleImageSearch.ToLowerString()"
                                                        data-show-image-search="@Model.ShowImageSearchEnabled.ToLowerString()"
                                                        on-init="product.initProductPhotos(productPhotos)"
                                                        on-upload-photo="product.updateMainPhoto(mainPhoto)"
                                                        on-change-main-photo="product.updateMainPhoto(mainPhoto)"
                                                        on-delete-photo="product.updateMainPhoto(mainPhoto)"></product-photos>
                                        <product-photos360 data-product-id="@Model.ProductId"></product-photos360>
                                    </div>
                                </div>
                            </div>

                            <div class="product-setting product-setting--video" lozad-adv="product.scrollToActiveElement('productVideosShowed')" @*in-view="$inview ? product.productVideosShowed = true : null" in-view-options="{throttle : @inViewThrottle}"*@>
                                <div id="video">
                                    <product-videos ng-if="product.productVideosShowed" class="ng-cloak" data-product-id="@Model.ProductId"></product-videos>
                                </div>
                            </div>

                            <div class="product-setting product-setting--description">
                                <div id="description">
                                    <div>
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <h2 class="inline product-setting-title content-header">@T("Admin.Product.Edit.Description")</h2>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="container-fluid">
                                            <div class="form-group row">
                                                <div class="col-xs-2">
                                                    <div class="m-b-wl">
                                                        <div class="bold">@T("Admin.Product.Edit.ShortDescription")</div>
                                                        <span>@T("Admin.Product.Edit.ListedInListOfProducts")</span>
                                                    </div>
                                                </div>
                                                <div class="col-xs-10">
                                                    <div ng-if="form.BriefDescription.$error.maxlength" class="m-b-xs error-color bold">@T("Admin.TextLengthLimit.Format", AdvantShop.Catalog.ProductService.MaxDescLength)</div>
                                                    @Html.TextAreaFor(x => x.BriefDescription, new { @class = "wysiwyg", ckeditor = "{height: 150}", maxlength = AdvantShop.Catalog.ProductService.MaxDescLength, ng_model = "product.briefdescription" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="container-fluid">
                                            <div class="form-group row">
                                                <div class="col-xs-2">
                                                    <div class="bold">@T("Admin.Product.Edit.Description")</div>
                                                    <span>@T("Admin.Product.Edit.DisplayedInProductCard")</span>
                                                </div>
                                                <div class="col-xs-10">
                                                    <div ng-if="form.Description.$error.maxlength" class="m-b-xs error-color bold">@T("Admin.TextLengthLimit.Format", AdvantShop.Catalog.ProductService.MaxDescLength)</div>
                                                    @Html.TextAreaFor(x => x.Description, new { @class = "wysiwyg", ckeditor = "", maxlength = AdvantShop.Catalog.ProductService.MaxDescLength, ng_model = "product.description" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="product-setting product-setting--properties" lozad-adv="product.scrollToActiveElement('productPropertiesShowed')" @*in-view="$inview ? product.productPropertiesShowed = true : null" in-view-options="{throttle : @inViewThrottle}"*@>
                                <div id="properties">
                                    <product-properties ng-if="product.productPropertiesShowed" class="ng-cloak" data-product-id="@Model.ProductId"></product-properties>
                                </div>
                            </div>

                            <div class="product-setting product-setting--reviews" lozad-adv="product.scrollToActiveElement('productReviewsShowed')">
                                <div id="reviews">
                                    <product-reviews ng-if="product.productReviewsShowed" class="ng-cloak" data-product-id="@Model.ProductId"></product-reviews>
                                </div>
                            </div>
                            @*@if (Model.HasCustomOptions)
                                {*@
                            <div class="product-setting product-setting--customoptions">
                                <div id="customoptions">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <h2 class="inline product-setting-title content-header">@T("Admin.Product.Edit.AdditionalOptions")</h2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <div>
                                                    <ui-modal-trigger size="lg" data-controller="'ModalCustomOptionsCtrl'" controller-as="ctrl"
                                                                      data-resolve="{productId: product.productId}"
                                                                      template-url="../areas/admin/content/src/product/modal/customOptions/customOptions.html">
                                                        <a href="">@T("Admin.Product.Edit.EditAddOptions")</a>
                                                    </ui-modal-trigger>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @*}*@

                            <div class="product-setting product-setting--SEO">
                                <div id="SEO">
                                    @Html.Partial("_Seo", Model)
                                </div>
                            </div>

                            @if (!SaasDataService.IsSaasEnabled || SaasDataService.CurrentSaasData.HaveLandingFunnel)
                            {
                                <div class="product-setting product-setting--additionalSales">
                                    <div id="additionalSales">
                                        @Html.Partial("_LandingFunnels", Model)
                                    </div>
                                </div>
                            }

                            <div class="product-setting product-setting--lists" lozad-adv="product.scrollToActiveElement('productListShowed')">
                                <div id="lists">
                                    <div class="ng-cloak" ng-if="product.productListShowed">
                                        @Html.Partial("_Lists", Model)
                                    </div>
                                </div>
                            </div>


                            <div class="product-setting product-setting--avito">
                                <div id="avito">
                                    @Html.Partial("_AvitoProductFields", Model)
                                </div>
                            </div>

                            @for (int i = 0; i < Model.TabModules.Count; i++)
                            {
                                var module = Model.TabModules[i];

                                <div class="product-setting">
                                    <div id="tab@(i)">
                                        @Html.Action(module.Route.ActionName, module.Route.ControllerName, new { productId = Model.ProductId, area = "" })
                                    </div>
                                </div>
                            }

                            @Html.RenderModules("admin_product_bottom", new { productId = Model.ProductId })
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>