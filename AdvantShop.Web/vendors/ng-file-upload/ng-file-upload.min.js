(function(){function e(n,t){window.XMLHttpRequest.prototype[n]=t(window.XMLHttpRequest.prototype[n])}function o(n,t,r,f,e,o,s){function h(){return t[0].tagName.toLowerCase()==="input"&&t.attr("type")&&t.attr("type").toLowerCase()==="file"}function a(t){var h,l;if(!c){c=!0;try{var a=t.__files_||t.target&&t.target.files,s=[],v=[];for(h=0;h<a.length;h++)l=a.item(h),i(n,e,r,l,t)?s.push(l):v.push(l);u(e,o,n,f,r,r.ngfChange||r.ngfSelect,s,v,t);s.length==0&&(t.target.value=s)}finally{c=!1}}}function v(i){var f,u;for(r.ngfMultiple&&i.attr("multiple",e(r.ngfMultiple)(n)),e(r.ngfMultiple)(n)||i.attr("multiple",undefined),r.accept&&i.attr("accept",r.accept),r.ngfCapture&&i.attr("capture",e(r.ngfCapture)(n)),f=0;f<t[0].attributes.length;f++)u=t[0].attributes[f],(h()&&u.name!=="type"||u.name!=="type"&&u.name!=="class"&&u.name!=="id"&&u.name!=="style")&&i.attr(u.name,u.value)}function y(){if(!t.attr("disabled")){var i=angular.element('<input type="file">');return v(i),h()?(t.replaceWith(i),t=i,i.attr("__ngf_gen__",!0),s(t)(n)):(i.css("visibility","hidden").css("position","absolute").css("width","1").css("height","1").css("z-index","-100000").attr("tabindex","-1"),t.__ngf_ref_elem__&&t.__ngf_ref_elem__.remove(),t.__ngf_ref_elem__=i,document.body.appendChild(i[0])),i}}function p(t){u(e,o,n,f,r,r.ngfChange||r.ngfSelect,[],[],t,!0)}function l(n){n!=null&&(n.preventDefault(),n.stopPropagation());var i=y(n);if(i){i.bind("change",a);n&&p(n);function r(n){n!=null&&i[0].click();h()&&t.bind("click touchend",l)}navigator.userAgent.toLowerCase().match(/android/)?setTimeout(function(){r(n)},0):r(n)}return!1}if(!t.attr("__ngf_gen__")){var c=!1;window.FileAPI&&window.FileAPI.ngfFixIE?window.FileAPI.ngfFixIE(t,y,v,a,p):(l(),h()||t.bind("click touchend",l))}}function s(n,t,f,e,o,s,h){function p(n,t,r){var s=!0,e=r.dataTransfer.items,f,u;if(e!=null)for(f=0;f<e.length&&s;f++)s=s&&(e[f].kind=="file"||e[f].kind=="")&&i(n,o,t,e[f],r);return u=o(t.ngfDragOverClass)(n,{$event:r}),u&&(u.delay&&(y=u.delay),u.accept&&(u=s?u.accept:u.reject)),u||t.ngfDragOverClass||"dragover"}function w(t,r,u,e){function y(r){i(n,o,f,r,t)?l.push(r):k.push(r)}function g(n,t,i){var f,e,r,u;t!=null&&(t.isDirectory?(f=(i||"")+t.name,y({name:t.name,type:"directory",path:f}),e=t.createReader(),r=[],a++,u=function(){e.readEntries(function(f){try{if(f.length)r=r.concat(Array.prototype.slice.call(f||[],0)),u();else{for(var e=0;e<r.length;e++)g(n,r[e],(i?i:"")+t.name+"/");a--}}catch(o){a--;console.error(o)}},function(){a--})},u()):(a++,t.file(function(n){try{a--;n.path=(i?i:"")+n.name;y(n)}catch(t){a--;console.error(t)}},function(){a--})))}var l=[],k=[],v=t.dataTransfer.items,a=0,p,b,w,c,d;if(v&&v.length>0&&h.protocol()!="file")for(c=0;c<v.length;c++){if(v[c].webkitGetAsEntry&&v[c].webkitGetAsEntry()&&v[c].webkitGetAsEntry().isDirectory){if(p=v[c].webkitGetAsEntry(),p.isDirectory&&!u)continue;p!=null&&g(l,p)}else b=v[c].getAsFile(),b!=null&&y(b);if(!e&&l.length>0)break}else if(w=t.dataTransfer.files,w!=null)for(c=0;c<w.length;c++)if(y(w.item(c)),!e&&l.length>0)break;d=0,function nt(n){s(function(){if(a)d++*10<2e4&&nt(10);else{if(!e&&l.length>1){for(c=0;l[c].type=="directory";)c++;l=[l[c]]}r(l,k)}},n||0)}()}var l=r();if(f.dropAvailable&&s(function(){n[f.dropAvailable]?n[f.dropAvailable].value=l:n[f.dropAvailable]=l}),!l){o(f.ngfHideOnDropNotAvailable)(n)==!0&&t.css("display","none");return}var v=null,a=o(f.ngfStopPropagation),y=1,b=o(f.ngfAccept),c;t[0].addEventListener("dragover",function(i){if(!t.attr("disabled")){if(i.preventDefault(),a(n)&&i.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var r=i.dataTransfer.effectAllowed;i.dataTransfer.dropEffect="move"===r||"linkMove"===r?"move":"copy"}s.cancel(v);n.actualDragOverClass||(c=p(n,f,i));t.addClass(c)}},!1);t[0].addEventListener("dragenter",function(i){t.attr("disabled")||(i.preventDefault(),a(n)&&i.stopPropagation())},!1);t[0].addEventListener("dragleave",function(){t.attr("disabled")||(v=s(function(){t.removeClass(c);c=null},y||1))},!1);t[0].addEventListener("drop",function(i){t.attr("disabled")||(i.preventDefault(),a(n)&&i.stopPropagation(),t.removeClass(c),c=null,w(i,function(t,r){u(o,s,n,e,f,f.ngfChange||f.ngfDrop,t,r,i)},o(f.ngfAllowDir)(n)!=!1,f.multiple||o(f.ngfMultiple)(n)))},!1)}function r(){var n=document.createElement("div");return"draggable"in n&&"ondrop"in n}function u(n,t,i,r,u,f,e,o,s,h){function c(){r&&(n(u.ngModel).assign(i,e),t(function(){r&&r.$setViewValue(e!=null&&e.length==0?null:e)}));u.ngModelRejected&&n(u.ngModelRejected).assign(i,o);f&&n(f)(i,{$files:e,$rejectedFiles:o,$event:s})}h?c():t(function(){c()})}function i(n,t,i,r,u){var e=t(i.ngfAccept)(n,{$file:r,$event:u}),s=t(i.ngfMaxSize)(n,{$file:r,$event:u})||9007199254740991,h=t(i.ngfMinSize)(n,{$file:r,$event:u})||-1,o;return e!=null&&angular.isString(e)&&(o=new RegExp(f(e),"gi"),e=r.type!=null&&o.test(r.type.toLowerCase())||r.name!=null&&o.test(r.name.toLowerCase())),(e==null||e)&&(r.size==null||r.size<s&&r.size>h)}function f(n){var i,t,r;if(n.length>2&&n[0]==="/"&&n[n.length-1]==="/")return n.substring(1,n.length-1);if(i=n.split(","),t="",i.length>1)for(r=0;r<i.length;r++)t+="("+f(i[r])+")",r<i.length-1&&(t+="|");else n.indexOf(".")==0&&(n="*"+n),t="^"+n.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",t=t.replace(/\\\*/g,".*").replace(/\\\?/g,".");return t}var n,t;window.XMLHttpRequest&&!window.XMLHttpRequest.__isFileAPIShim&&e("setRequestHeader",function(n){return function(t,i){if(t==="__setXHR_"){var r=i(this);r instanceof Function&&r(this)}else n.apply(this,arguments)}});t=angular.module("ngFileUpload",[]);t.version="4.2.4";t.service("Upload",["$http","$q","$timeout",function(t,i,r){function u(n){n.method=n.method||"POST";n.headers=n.headers||{};n.transformRequest=n.transformRequest||function(n,i){return window.ArrayBuffer&&n instanceof window.ArrayBuffer?n:t.defaults.transformRequest[0](n,i)};var f=i.defer(),u=f.promise;return n.headers.__setXHR_=function(){return function(t){t&&(n.__XHR=t,n.xhrFn&&n.xhrFn(t),t.upload.addEventListener("progress",function(t){t.config=n;f.notify?f.notify(t):u.progress_fn&&r(function(){u.progress_fn(t)})},!1),t.upload.addEventListener("load",function(t){t.lengthComputable&&(t.config=n,f.notify?f.notify(t):u.progress_fn&&r(function(){u.progress_fn(t)}))},!1))}},t(n).then(function(n){f.resolve(n)},function(n){f.reject(n)},function(n){f.notify(n)}),u.success=function(t){return u.then(function(i){t(i.data,i.status,i.headers,n)}),u},u.error=function(t){return u.then(null,function(i){t(i.data,i.status,i.headers,n)}),u},u.progress=function(n){return u.progress_fn=n,u.then(null,null,function(t){n(t)}),u},u.abort=function(){return n.__XHR&&r(function(){n.__XHR.abort()}),u},u.xhr=function(t){return n.xhrFn=function(n){return function(){n&&n.apply(u,arguments);t.apply(u,arguments)}}(n.xhrFn),u},u}this.upload=function(t){return t.headers=t.headers||{},t.headers["Content-Type"]=undefined,t.transformRequest=t.transformRequest?angular.isArray(t.transformRequest)?t.transformRequest:[t.transformRequest]:[],t.transformRequest.push(function(i){var f=new FormData,u={},r,o,s,e;for(n in t.fields)t.fields.hasOwnProperty(n)&&(u[n]=t.fields[n]);if(i&&(u.data=i),t.formDataAppender)for(n in u)u.hasOwnProperty(n)&&t.formDataAppender(f,n,u[n]);else for(n in u)u.hasOwnProperty(n)&&(r=u[n],r!==undefined&&(angular.isDate(r)&&(r=r.toISOString()),angular.isString(r)?f.append(n,r):t.sendObjectsAsJsonBlob&&angular.isObject(r)?f.append(n,new Blob([r],{type:"application/json"})):f.append(n,JSON.stringify(r))));if(t.file!=null)if(o=t.fileFormDataName||"file",angular.isArray(t.file))for(s=angular.isString(o),e=0;e<t.file.length;e++)f.append(s?o:o[e],t.file[e],t.fileName&&t.fileName[e]||t.file[e].name);else f.append(o,t.file,t.fileName||t.file.name);return f}),u(t)};this.http=function(n){return u(n)}}]);t.directive("ngfSelect",["$parse","$timeout","$compile",function(n,t,i){return{restrict:"AEC",require:"?ngModel",link:function(r,u,f,e){o(r,u,f,e,n,t,i)}}}]);t.directive("ngfDrop",["$parse","$timeout","$location",function(n,t,i){return{restrict:"AEC",require:"?ngModel",link:function(r,u,f,e){s(r,u,f,e,n,t,i)}}}]);t.directive("ngfNoFileDrop",function(){return function(n,t){r()&&t.css("display","none")}});t.directive("ngfDropAvailable",["$parse","$timeout",function(n,t){return function(i,u,f){if(r()){var e=n(f.ngfDropAvailable);t(function(){e(i);e.assign&&e.assign(i,!0)})}}}]);t.directive("ngfSrc",["$parse","$timeout",function(n,t){return{restrict:"AE",link:function(r,u,f){window.FileReader&&r.$watch(f.ngfSrc,function(e){e&&i(r,n,f,e,null)&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 8")===-1||e.size<2e4)&&(!window.FileAPI||navigator.userAgent.indexOf("MSIE 9")===-1||e.size<4e6)?t(function(){var n=window.URL||window.webkitURL,i;n&&n.createObjectURL?u.attr("src",n.createObjectURL(e)):(i=new FileReader,i.readAsDataURL(e),i.onload=function(n){t(function(){u.attr("src",n.target.result)})})}):u.attr("src",f.ngfDefaultSrc||"")})}}}])})();
//# sourceMappingURL=ng-file-upload.min.js.map
